###############################################################################
# Mosquitto MQTT Broker Configuration Template (SAFE TO COMMIT)
#
# Copy to:
#   mosquitto.env
# Edit mosquitto.env locally with real values (do NOT commit mosquitto.env).
###############################################################################

# NETWORK / LISTENERS
MOSQ_LISTENER_PORT=8883
MOSQ_BIND_ADDRESS=0.0.0.0

# MOSQUITTO CONFIG PATHS
MOSQ_CONF_MAIN=/etc/mosquitto/mosquitto.conf
MOSQ_CONF_DIR=/etc/mosquitto/conf.d

# TLS CERTS (Let's Encrypt layout recommended)
# IMPORTANT: these paths must match LETSENCRYPT_DOMAIN below
MOSQ_CA_FILE=/etc/letsencrypt/live/mqtt.example.com/fullchain.pem
MOSQ_CERT_FILE=/etc/letsencrypt/live/mqtt.example.com/fullchain.pem
MOSQ_KEY_FILE=/etc/letsencrypt/live/mqtt.example.com/privkey.pem

# AUTH (PASSWORD FILE)
MOSQ_PASSWORD_FILE=/etc/mosquitto/passwd
MOSQ_ALLOW_ANONYMOUS=false

# Optionally create one initial user during install (you can add more later)
# If MQTT_PASSWORD is blank, installer will prompt securely.
CREATE_MQTT_USER=true
MQTT_USERNAME=changeme
MQTT_PASSWORD=

# ACL (RECOMMENDED)
MOSQ_ENABLE_ACL=true
MOSQ_ACL_FILE=/etc/mosquitto/aclfile
# If enabled, installer can optionally write a starter ACL allowing the initial user
# to publish/subscribe under a single prefix.
WRITE_DEFAULT_ACL=true
ACL_TOPIC_PREFIX=test/#

# LOGGING
# Valid values: stdout, stderr, syslog, topic, file
MOSQ_LOG_DEST=file
MOSQ_LOG_FILE=/var/log/mosquitto/mosquitto.log

# PERSISTENCE
MOSQ_PERSISTENCE=true
MOSQ_PERSISTENCE_LOCATION=/var/lib/mosquitto/

# FIREWALL (UFW)
UFW_ALLOW=true
# Strongly recommended false on an internet-facing VPS
OPEN_PLAINTEXT_1883=false

# OPTIONAL: MUTUAL TLS (ADVANCED)
REQUIRE_CLIENT_CERT=false

# LET'S ENCRYPT AUTOMATION
LETSENCRYPT_ENABLE=true
LETSENCRYPT_DOMAIN=mqtt.example.com
LETSENCRYPT_EMAIL=admin@example.com
LETSENCRYPT_STAGING=false

# LET'S ENCRYPT PERMISSIONS
# Some Ubuntu installs keep /etc/letsencrypt/{live,archive} as 0700 root:root,
# which prevents mosquitto from traversing symlinks to privkey*.pem.
LETSENCRYPT_FIX_DIR_PERMS=true
